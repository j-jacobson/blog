<DOCTYPE! html>
<html style="background-color: lightgreen">
<head>
<title>Jonathan's Project Blog 1.0</title>
<link rel="shortcut icon" href="images/x220t.ico" />
<style>
table, th, td {
    border: 1px solid black;
}
th, td {
    padding: 5px;
    text-align: center;    
}
</style>
</style>
</head>
<body>
<table style="border: black 1pt;">
<td>
<table style="border: black 1pt;">
<tr>
<td style="width: 15%; width-min: 100px; height:100%; margin-top: 150px;" rowspan="3">
<div style="margin-top: 150px; height: 98%; text-decoration: underline;"><a title="Recent" href="recent.html">Recent</a><br /><a title="Projects" href="projects.html">Projects</a><br /><a href="mailto:jlj3@illinois.edu?Subject=I%20clicked%20on%20the%20button%20to%20send%20you%20an%20email" target="_top">Email</a></div>
</td>
<td style="height: 125px;"><h1>Jonathan's Project Blog 1.0</h1></td>
</tr>
<tr>
<td style="height: 25px;"><a title="Home" href="index.html">Home</a> | <a title="iPod" href="iPod.html">iPod</a> | <a title="Thinkpad" href="Thinkpad.html">Thinkpad</a> | Software | Other | <a title="About" href="about.html">About</a></td>
</tr>
<tr>
<td>
<div style="text-align: left; height: 98%; padding: 30px;">
<h2 style="text-align: center;">Upgrading the iPod Classic 4th Generation Grayscale to a Larger Battery</h2>
<p>Jonathan Jacobson<br/>03.01.18</p>
<hr />
<p>
&emsp;&emsp;&emsp;&emsp;The iPod Classic 4th Generation grayscale comes stock with an incredibly small battery, in both physical size and capacity (I believe it was 800mAh) <a title="iPod Specs" href="https://everymac.com/systems/apple/ipod/specs/ipod_4thgen.html">iPod 4g Spec Sheet</a> . The original battery is about 1" by 1.5" and fits into a contour in the motherboard, a horrible design decision that was corrected in later models, but one that cannot be helped when modifying the 4th Gen.<br /><br /><div style="text-align: center"><a title="Click to Expand in New Tab" href="images/ipod_original_bat.JPG" target="about_blank"><img src="images/ipod_original_bat.JPG" alt="iPod with normal-sized battery installed" width=200px></a><br/><h10 style="font-size:12px;">Click to Expand in New Tab</h10></div><br />
&emsp;&emsp;&emsp;&emsp;However, due to this design only batteries that can fit in this small space can be installed into the iPod, limiting the maximum capacity of a replacement battery to about 1300mAh, which is better than the stock but still quite pitiful. Since I had done a previous modification to replace the bulky hard drive with a "IDE to CF to SD to microSD card" adapter, I wanted to try and put something larger in, and I figured 3000mAh would be enough for a day or two. I found a 3000mAh battery that was almost exactly the size of the back compartment of the iPod, and hoped it would fit in there with the limited space I had at my disposal.<br /><br /><div style="text-align: center"><a title="Click to Expand in New Tab" href="images/thiccPod.JPG" target="about_blank"><img src="images/thiccPod.JPG" alt="iPod with 40GB backing installed" width=350px></a><br/><h10 style="font-size:12px;">Click to Expand in New Tab</h10></div><br />
&emsp;&emsp;&emsp;&emsp;Of course, it did not fit. Luckily faked 40GB iPod backings are still being made today (and they look quite good), and I was able to source one. It held my new battery and made my iPod look even better than it did before!<br /><br /><div style="text-align: center"><a title="Click to Expand in New Tab" href="images/ipod_bat_connector.JPG" target="about_blank"><img src="images/ipod_bat_connector.JPG" alt="iPod battery connector" width=200px></a><br/><h10 style="font-size:12px;">Click to Expand in New Tab</h10></div><br />
&emsp;&emsp;&emsp;&emsp;Getting the battery into the compartment was the easy part, the real issue was getting the battery to charge from the motherboard of the iPod. The stock batteries and replacements specifically for the iPod all come with three wires - red (positive), black (negative), and yellow (charging positive). I didn't know exactly how the charging circuit worked, and I figured that at least part of the circuit was meant to be on the battery itself. Unfortunately the 3000mAh battery I found on eBay only came with two wires - red and black. Before I figured out what the yellow cable was for I had just left it unattached and hoped it would work but it did not.<br /><br /><div style="text-align: center"><a title="Click to Expand in New Tab" href="images/ipod_bat_connector.JPG" target="about_blank"><img src="images/ipod_bat_connector.JPG" alt="iPod battery connector" width=200px></a><br/><h10 style="font-size:12px;">Click to Expand in New Tab</h10></div><br />
&emsp;&emsp;&emsp;&emsp;Heading once again to eBay, I found a 3.7 V Li-Ion battery charging circuit that utilized the  4056a battery charging IC, and attempted to install it using the yellow wire as In+ (input positive), and black as both Batt- (battery negative) and In- (input negative). This however also did not work because the charging circuit required at least 4.2 V (4.5 on the datasheet but 4.2 worked just fine in tests), and the voltage drop between the yellow and black wires would only get up to that voltage with no battery connected. When the battery was connected it would only output 3.7 volts, not enough to turn the circuit on and charge the battery.<br /><br /><div style="text-align: center"><a title="Click to Expand in New Tab" href="images/ipod_charging_circuit.JPG" target="about_blank"><img src="images/ipod_charging_circuit.JPG" alt="iPod charging circuit" width=200px></a><br/><h10 style="font-size:12px;">Click to Expand in New Tab</h10></div><br />
&emsp;&emsp;&emsp;&emsp;I thought about how I would be able to get the input voltage to at least 4.2V, and I experimented with ways like adding another 1.5V battery to the circuit to try and boost the input voltage, but this did not work for a multitude of reasons. First, I had no battery on hand that would fit in the case with that voltage, secondly I would have to build another circuit to make sure the second battery would blow up from essentially inputting 3.7V into it, and finally I did not want to have to change the batteries on this iPod just to be able to charge it! Eventually I scrapped this idea altogether and looked for a better solution. <br /><br />
&emsp;&emsp;&emsp;&emsp;Since I needed at least 4.2V, I remembered that by definition USB charging puts out 5V to the device, and I figured there might be some way to tap directly into that 5V to charge the battery. Since the only place I felt comfortable pulling the 5V from was the connector itself, I went online and found the pinout for the Apple 30 Pin connector used on the iPod classics. With my multimeter and the datasheet I determined that Pin 23 was the 5V USB positive, and there were a multitude of ground pins that would work - I chose pin 1. However because there are a total of 30 pins on the 30 pin connector, the connections are incredibly small. Luckily the ones surrounding the 5V USB+ are reserved for Firewire connections, which I won't be using anytime soon, so I figured I had some wiggle room. I decided to solder directly to the backside of the connector instead of to a pad nearby because it would have taken much to long to find a suitable place, and I also did not want to scratch up the motherboard to reveal the traces. Eventually the soldering was complete, and connecting both wires to the circuit confirmed that the 5V output by the USB would be sufficient to charge the battery.<br /><br /><br /><div style="text-align: center"><table><tr><td><a title="Click to Expand in New Tab" href="images/30_pin_connector.JPG" target="about_blank"><img src="images/30_pin_connector.JPG" alt="iPod 30 Pin connector" width=200px></a></td><td style="text-align: left;"><a title="Click to Expand in New Tab" href="images/pinouts_full.jpg" target="about_blank"><img src="images/pin1.png" alt="30 Pin Connector Pinout" width=400px></a><br/><a title="Click to Expand in New Tab" href="images/pinouts_full.jpg" target="about_blank"><img src="images/pin23.png" alt="30 Pin Connector Pinout" width=412px></a><p>From <a href="http://pinouts.ru/PortableDevices/ipod_pinout.shtml" title="pinouts.ru">http://pinouts.ru/PortableDevices/ipod_pinout.shtml</a></td></tr></table>
<br/>
<h10 style="font-size:12px;">Click to Expand in New Tab</h10></div><br />
&emsp;&emsp;&emsp;&emsp;Originally I had put the battery, the motherboard battery socket, and the 5V USB together as a spaghetti mess of wires, but I had time so I went back and made it look better. I was very worried that my solder joints would not be strong enough and would disconnect sometime after I put the iPod back together, but after some testing I concluded it would be fine for now.<br /><br />
&emsp;&emsp;&emsp;&emsp;When everything was rigged together, I tested it one last time before closing the case, and it works! The red light means that the battery is charging.<br /><br /><div style="text-align: center"><a title="Click to Expand in New Tab" href="images/final_product.JPG" target="about_blank"><img src="images/final_product.JPG" alt="It works!" width=200px></a><br/><h10 style="font-size:12px;">Click to Expand in New Tab</h10></div><br />
&emsp;&emsp;&emsp;&emsp;The next morning, the iPod itself said that it was fully charged, but when I opened the case the red light was still on. I'm not sure if this is because the yellow wire was an integral part of the battery monitoring circuit, or if it is just programmed to check the charge against a battery of significantly less capacity. Either way, I think the battery was charging all night so I listened to music all day and recorded if and when it died. The battery was pretty low before charging so if it was in fact not charging it should have died relatively soon. If it makes it the whole day then I will assume it was charging.<br /><br /><div style="text-align: center"><a title="Click to Expand in New Tab" href="images/maybe_charged.JPG" target="about_blank"><img src="images/maybe_charged.JPG" alt="Possibly charged iPod" width=200px></a><br/><h10 style="font-size:12px;">Click to Expand in New Tab</h10></div><br />
&emsp;&emsp;&emsp;&emsp;This setup lasted a whole day and seemed to work smoothly, but the next morning I felt the need to go and change it. The relatively weak solder points from the battery charging circuit to the back of the 30 pin connector were making me nervous, so I decided to find some other contacts on the motherboard that I could hook this charging circuit to. Taking my multimeter, I was able to find a pad nearby that provided 4.5V when charging and 3.7V otherwise, which is great! It was a bit strange though because it only required the In+ cable to be connected to work!! This was very confusing and I thought that maybe somehow it was being short circuited across some metal strip on the casing, but I ended up concluding that the ground between the In- and Batt- was internally connected in the charging circuit, and it did not need a second grounding. To be safe though I did connect the ground to the pad next to the positive one. This setup does worry me by the fact that the pads gave 3.7V no matter what, which makes me think that I am charging the battery using itself! I don't know exactly how this would affect the battery itself, but it does not sound good.<br /><br /><div style="text-align: center"><a title="Click to Expand in New Tab" href="images/new_setup.JPG" target="about_blank"><img src="images/new_setup.JPG" alt="New Setup" width=200px></a><br/><h10 style="font-size:12px;">Click to Expand in New Tab</h10></div><br/><br/>
&emsp;&emsp;&emsp;&emsp;Issues with this modification include some excess solder that had fallen across pins 24-26 and was irremovable (these are the USB data-, firewire data+, and firewire data-. Hopefully it will not affect USB data- in a negative way), the unused yellow cable coming from the motherboard and the inaccurate battery sensor. Had I a schematic sheet for the iPod itself I could figure out exactly how the battery charging circuit works and what exactly the yellow wire does. I suspect that the charging circuit might actually be on the motherboard because with no battery connected the voltage drop between the yellow (+) and black (-) wires was 4.2V, which is what the charging circuit gives the battery when it is charging from a state of low charge. As the battery gets more full, I wonder if the Y-B voltage drop will decrease like is needed to charge the battery, or if it will continue to stay at 4.2V and damage the battery due to not being able to read the charge level correctly and adjust for it.<br /><br />
&emsp;&emsp;&emsp;&emsp;Future modifications might include creating a battery charging circuit that can work with the voltages output by the motherboard cables, but due to the highest voltage given being 3.7V when a minimum for 4.2 is needed to turn on the IC, this seems unlikely unless I can find schematics for the circuit that was built onto replacement batteries. However if new information is received and this project is updated this paper will reflect that. <br /><br />
<br />
<p>
</div>
</td> 
</tr>
</table>
</td>
</table>
</body>
</html>